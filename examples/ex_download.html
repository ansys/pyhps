
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Download of output files &#8212; PyREP</title>
    
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/ansys_sphinx_theme.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    
        <link href="../_static/css/breadcrumbs.css" rel="stylesheet">
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adding a file to a project" href="ex_adding_file.html" />
    <link rel="prev" title="Creating A Project" href="ex_motorbike_frame.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    <img src="../_static/pyansys-logo-black-cropped.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/pyansys-logo-black-cropped.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../install.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../quickstart.html">
  Quickstart
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/index.html">
  Code Documentation
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyansys/pyrep" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    
    
        <div class="container-xl">
    <div class="row">
        <div class="col-12 col-md-3" id="breadcrumbs-spacer"></div>
        <div class="col-12 col-md-11 col-xl-9" id="breadcrumbs">
          
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
    
        <li class="nav-item nav-item-additional-breadcrumb"><a href="https://docs.pyansys.com/">PyAnsys</a> » </li>
    
    
        <li class="nav-item nav-item-0"><a href="../index.html">PyREP</a> » </li>
    

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Examples</a> » </li>
        <li class="nav-item nav-item-this"><a href="">Download of output files</a></li> 
      </ul>
    </div>
        </div>
  </div>
</div>
    


    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ex_motorbike_frame.html">
   Creating A Project
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Download of output files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ex_adding_file.html">
   Adding a file to a project
  </a>
 </li>
</ul>

    
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#log-files">
   Log files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#images">
   Images
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parsing-of-log-files">
   Parsing of log files
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="download-of-output-files">
<span id="example-download-files"></span><h1>Download of output files<a class="headerlink" href="#download-of-output-files" title="Permalink to this heading">#</a></h1>
<p>This example shows how to download the output files of design points.
We assume you have already completed the <a class="reference internal" href="ex_motorbike_frame.html#example-mapdl-motorbike-frame"><span class="std std-ref">Creating A Project</span></a> tutorial and have the MAPDL Motorbike Frame project at hand.</p>
<p>To begin with, we connect to a DCS server running on the localhost with default username and password
and specify the local path where the files are going to be saved.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before executing the code, make sure to adjust the <code class="docutils literal notranslate"><span class="pre">download_path</span></code> variable.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">ansys.rep.client.jms</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="c1"># Connect to the DCS server and query the project</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">rep_url</span><span class="o">=</span><span class="s2">&quot;https://127.0.0.1:8443/rep&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s2">&quot;repadmin&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;repadmin&quot;</span><span class="p">)</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_project</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;mapdl_motorbike_frame&quot;</span><span class="p">)</span>

<span class="c1"># Specify the base path where to download files</span>
<span class="n">download_path</span> <span class="o">=</span> <span class="c1">#e.g. &#39;C:\\Users\\your_username\\Documents\\mapdl_motorbike_frame\\download&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">download_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_path</span><span class="p">)</span>
</pre></div>
</div>
<section id="log-files">
<h2>Log files<a class="headerlink" href="#log-files" title="Permalink to this heading">#</a></h2>
<p>We first show how to download the log files. To this end, let’s first get all evaluated and failed design points.
Note that we specify the <code class="docutils literal notranslate"><span class="pre">fields</span></code> query parameter to restrict the returned fields to the ones we actually need for this example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dps</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">get_jobs</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="s2">&quot;eval_status&quot;</span><span class="p">],</span> <span class="n">eval_status</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;evaluated&quot;</span><span class="p">,</span> <span class="s2">&quot;failed&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Also note that each design point holds a list of file IDs linked to it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">file_ids</span><span class="p">)</span>
<span class="c1">#Output (numbers could be different)</span>
<span class="c1">#[6, 7, 8, 36, 1]</span>
</pre></div>
</div>
<p>For each design point, we now download the content of its <code class="docutils literal notranslate"><span class="pre">file.out</span></code> log file (which contains the APDL output) and save it to disk.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="n">dps</span><span class="p">:</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading log file of design point </span><span class="si">{</span><span class="n">dp</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> ...&quot;</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">get_files</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dp</span><span class="o">.</span><span class="n">file_ids</span><span class="p">,</span> <span class="n">evaluation_path</span><span class="o">=</span><span class="s2">&quot;file.out&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># If some content is found (it&#39;s not the case if the design point fails</span>
    <span class="c1"># even before starting the simulation) we save it to disk.</span>
    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_dp</span><span class="si">{</span><span class="n">dp</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tf</span><span class="p">:</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With the <code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">evaluation</span> <span class="pre">path</span></code> query parameters in the <code class="docutils literal notranslate"><span class="pre">get_files</span></code> function we specify that we are only
interested in the <code class="docutils literal notranslate"><span class="pre">file.out</span></code> produced by the current design point.
Moreover, by setting <code class="docutils literal notranslate"><span class="pre">content=True</span></code> we effectively download the file content and
not only its metadata.</p>
</div>
</section>
<section id="images">
<h2>Images<a class="headerlink" href="#images" title="Permalink to this heading">#</a></h2>
<p>Similarly, we can download the images associated to the design points. In this example, for each design point
we download and save all JPEG images.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="n">dps</span><span class="p">:</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading image files of design point </span><span class="si">{</span><span class="n">dp</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> ... &quot;</span><span class="p">)</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">get_files</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">dp</span><span class="o">.</span><span class="n">file_ids</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;image/jpeg&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_dp</span><span class="si">{</span><span class="n">dp</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">.jpg&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bf</span><span class="p">:</span>
                <span class="n">bf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="parsing-of-log-files">
<h2>Parsing of log files<a class="headerlink" href="#parsing-of-log-files" title="Permalink to this heading">#</a></h2>
<p>The possibility to download and parse log files can be particularly useful when design point failures need to be investigated.
Consider for instance the case where design points are submitted to DPS from a Workbench project.
Suppose that unexpected failures are observed for different reasons. For instance, some might be due to parameter values resulting in invalid job_definitions,
others could be related to non-convergence of some intermediate steps, some others could instead be caused by hardware failure.</p>
<p>To systematically investigate such cases, one could for instance download the log files of failed design points and parse the content looking for specific
failure indicators.</p>
<p>Downloading the log files goes along the lines of the examples above. Note however the different query parameters
used in the <code class="docutils literal notranslate"><span class="pre">get_files</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">ansys.rep.client.jms</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="c1"># Connect to the DCS server and query the project</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">rep_url</span><span class="o">=</span><span class="s2">&quot;https://127.0.0.1:8443/rep&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s2">&quot;repadmin&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;repadmin&quot;</span><span class="p">)</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_project</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;project_id&quot;</span><span class="p">)</span>

<span class="c1"># Specify the base path where to download files</span>
<span class="n">download_path</span> <span class="o">=</span> <span class="c1">#e.g. &#39;C:\\Users\\your_username\\Documents\\project_id\\download&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">download_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_path</span><span class="p">)</span>

<span class="c1"># Get all failed design points</span>
<span class="n">failed_dps</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">get_jobs</span><span class="p">(</span><span class="n">eval_status</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;failed&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> failed design points&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">failed_dps</span><span class="p">))</span>

<span class="c1"># for each design point, download its workbench log file</span>
<span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="n">failed_dps</span><span class="p">:</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading log file of design point </span><span class="si">%d</span><span class="s2"> ... &quot;</span> <span class="o">%</span> <span class="n">dp</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="n">query_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">dp</span><span class="o">.</span><span class="n">file_ids</span><span class="p">,</span> <span class="s2">&quot;name.contains&quot;</span><span class="p">:</span> <span class="s2">&quot;log_Workbench_Project&quot;</span><span class="p">}</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">get_files</span><span class="p">(</span><span class="o">**</span><span class="n">query_params</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_dp</span><span class="si">{</span><span class="n">dp</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tf</span><span class="p">:</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>The actual parsing of the log files could be done for instance by first defining a dictionary of
failure strings to look for.
These could have been identified by prior knowledge of possible failure reasons or by manually inspecting some of the log files.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">failure_dict</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;failure_string&quot;</span><span class="p">:</span> <span class="s2">&quot;Could not find file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Missing file&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;failure_string&quot;</span><span class="p">:</span> <span class="s2">&quot;no longer available in the geometry&quot;</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Missing geometry&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;failure_string&quot;</span><span class="p">:</span> <span class="s2">&quot;Can&#39;t initialize Addin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Installation&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;failure_string&quot;</span><span class="p">:</span> <span class="s2">&quot;One or more entities failed to mesh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Meshing failure&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;failure_string&quot;</span><span class="p">:</span> <span class="s2">&quot;license&quot;</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;No License&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>For each design point, we then open the corresponding log file and test whether it contains any failure strings.
The results are collected in a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> dataframe object which can be easily queried or exported in <code class="docutils literal notranslate"><span class="pre">csv</span></code> or <code class="docutils literal notranslate"><span class="pre">xlsx</span></code> format.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Id&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Eval Status&quot;</span><span class="p">,</span> <span class="s2">&quot;Elapsed Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Failures&quot;</span><span class="p">])</span>

<span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="n">failed_dps</span><span class="p">:</span>
    <span class="n">log_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_path</span><span class="p">,</span> <span class="s2">&quot;log_Workbench_Project_dp</span><span class="si">%d</span><span class="s2">.txt&quot;</span> <span class="o">%</span> <span class="n">dp</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="n">errors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">log_file_path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">lf</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">errors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">failure_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;failure_string&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">errors</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Missing Log File&quot;</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
         <span class="s2">&quot;Id&quot;</span><span class="p">:</span> <span class="n">dp</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
         <span class="s2">&quot;Name&quot;</span><span class="p">:</span>  <span class="n">dp</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
         <span class="s2">&quot;Eval Status&quot;</span><span class="p">:</span>  <span class="n">dp</span><span class="o">.</span><span class="n">eval_status</span><span class="p">,</span>
         <span class="s2">&quot;Elapsed Time&quot;</span><span class="p">:</span>  <span class="n">dp</span><span class="o">.</span><span class="n">elapsed_time</span><span class="p">,</span>
         <span class="s2">&quot;Failures&quot;</span><span class="p">:</span> <span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
        <span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># Example export to Excel or CSV</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_path</span><span class="p">,</span> <span class="s2">&quot;failures.xlsx&quot;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># requires the openpyxl package to be available</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_path</span><span class="p">,</span> <span class="s2">&quot;failures.csv&quot;</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The dataframe will look like this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">Id</span> <span class="n">Name</span> <span class="n">Eval</span> <span class="n">Status</span>  <span class="n">Elapsed</span> <span class="n">Time</span>          <span class="n">Failures</span>
<span class="mi">0</span>   <span class="mi">6</span>    <span class="mi">8</span>      <span class="n">failed</span>    <span class="mf">137.543538</span>  <span class="n">Missing</span> <span class="n">geometry</span>
<span class="mi">1</span>   <span class="mi">7</span>    <span class="mi">9</span>      <span class="n">failed</span>     <span class="mf">86.561933</span>           <span class="n">Unknown</span>
<span class="mi">2</span>  <span class="mi">10</span>   <span class="mi">12</span>      <span class="n">failed</span>    <span class="mf">112.935375</span>  <span class="n">Missing</span> <span class="n">geometry</span><span class="p">;</span> <span class="n">Missing</span> <span class="n">file</span>
<span class="mi">3</span>  <span class="mi">11</span>   <span class="mi">13</span>      <span class="n">failed</span>    <span class="mf">138.019429</span>           <span class="n">License</span>
<span class="mi">4</span>  <span class="mi">18</span>   <span class="mi">20</span>      <span class="n">failed</span>    <span class="mf">133.204345</span>  <span class="n">Missing</span> <span class="n">geometry</span>
<span class="o">...</span>
</pre></div>
</div>
<p>By suitably querying the dataframe, one could then easily e.g. set to pending all design points which failed because of a specific reason.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ansys.rep.client.jms</span> <span class="kn">import</span> <span class="n">Job</span>

<span class="c1"># get the ID of design points which failed because of license issues</span>
<span class="n">ids</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Failures&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;License&quot;</span><span class="p">)][</span><span class="s2">&quot;Id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">dps_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">eval_status</span><span class="o">=</span><span class="s2">&quot;pending&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>
<span class="n">dps_of_interest</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">update_jobs</span><span class="p">(</span><span class="n">dps_of_interest</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright (c) 2022 ANSYS, Inc. All rights reserved.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>