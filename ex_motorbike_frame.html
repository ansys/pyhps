
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Creating A Project &#8212; pyrep</title>
    
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/ansys_sphinx_theme.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    
        <link href="_static/css/breadcrumbs.css" rel="stylesheet">
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Download of output files" href="ex_download.html" />
    <link rel="prev" title="Examples" href="examples.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">
  
  
  
  
    <img src="_static/pyansys-logo-black-cropped.png" class="logo__image only-light" alt="Logo image">
    <img src="_static/pyansys-logo-black-cropped.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="install.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="quickstart.html">
  Quickstart
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="examples.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api_reference.html">
  Code Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="changelog.html">
  Changelog
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="[https://github.com/pyansys/pyrep" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    
    
        <div class="container-xl">
    <div class="row">
        <div class="col-12 col-md-3" id="breadcrumbs-spacer"></div>
        <div class="col-12 col-md-11 col-xl-9" id="breadcrumbs">
          
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
    
        <li class="nav-item nav-item-additional-breadcrumb"><a href="https://docs.pyansys.com/">PyAnsys</a> » </li>
    
    
        <li class="nav-item nav-item-0"><a href="index.html">pyrep</a> » </li>
    

          <li class="nav-item nav-item-1"><a href="examples.html" accesskey="U">Examples</a> » </li>
        <li class="nav-item nav-item-this"><a href="">Creating A Project</a></li> 
      </ul>
    </div>
        </div>
  </div>
</div>
    


    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Creating A Project
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ex_download.html">
   Download of output files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ex_adding_file.html">
   Adding a file to a project
  </a>
 </li>
</ul>

    
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-modules-and-instantiate-the-dps-client">
   Import modules and instantiate the DPS client
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-an-empty-project-and-a-job-definition">
   Create an empty project and a job_definition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#file-resources">
   File resources
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parameters-definition">
   Parameters definition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#process-step">
   Process Step
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitness-definition">
   Fitness definition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submit-the-job-definition">
   Submit the job_definition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#design-points">
   Design Points
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="creating-a-project">
<span id="example-mapdl-motorbike-frame"></span><h1>Creating A Project<a class="headerlink" href="#creating-a-project" title="Permalink to this heading">#</a></h1>
<p>This example shows how to create from scratch a DCS project consisting of an Ansys APDL beam model
of a tubular steel trellis motorbike-frame.
After creating the project job_definition, 10 design points with randomly
chosen parameter values are created and set to pending.</p>
<a class="reference internal image-reference" href="_images/motorbike_frame.jpg"><img alt="motorbike frame picture" class="align-center" src="_images/motorbike_frame.jpg" style="width: 426.5px; height: 295.0px;" /></a>
<p>The model is parametrized as follows:</p>
<ul class="simple">
<li><p>three custom tube types are defined whose radius and thickness can vary in a certain range;</p></li>
<li><p>for each tube in the frame there is a string parameter specifying which custom type it should be made of;</p></li>
<li><p>output parameters of interest are the weight, the torsion stiffness and the maximum von Mises stress for a breaking load case.</p></li>
</ul>
<p>For further details about the finite element model and its parametrization, see
“Using Evolutionary Methods with a Heterogeneous Genotype Representation
for Design Optimization of a Tubular Steel Trellis Motorbike-Frame”, 2003
by U. M. Fasel, O. Koenig, M. Wintermantel and P. Ermanni.</p>
<p>The project setup script as well as the data files can be downloaded here <code class="xref download docutils literal notranslate"><span class="pre">MAPDL</span> <span class="pre">Motorbike</span> <span class="pre">Frame</span> <span class="pre">Project</span></code>.</p>
<p>We shall now dissect the project setup script in detail.</p>
<section id="import-modules-and-instantiate-the-dps-client">
<h2>Import modules and instantiate the DPS client<a class="headerlink" href="#import-modules-and-instantiate-the-dps-client" title="Permalink to this heading">#</a></h2>
<p>The script starts by importing some generic modules and some key <code class="docutils literal notranslate"><span class="pre">ansys-dcs-client</span></code> classes.
Next we connect to a DCS server running on the localhost with default username and password.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">from</span> <span class="nn">ansys.rep.client.jms</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">ansys.rep.client.jms.resource</span> <span class="kn">import</span> <span class="p">(</span><span class="n">JobDefinition</span><span class="p">,</span> <span class="n">Job</span><span class="p">,</span> <span class="n">File</span><span class="p">,</span>
                                           <span class="n">FitnessDefinition</span><span class="p">,</span> <span class="n">Project</span><span class="p">,</span>
                                           <span class="n">SuccessCriteria</span><span class="p">)</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">rep_url</span><span class="o">=</span><span class="s2">&quot;https://127.0.0.1/dcs&quot;</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s2">&quot;repadmin&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;repadmin&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-an-empty-project-and-a-job-definition">
<h2>Create an empty project and a job_definition<a class="headerlink" href="#create-an-empty-project-and-a-job-definition" title="Permalink to this heading">#</a></h2>
<p>Once the client is available, we can define a new project and send it to the server.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span> <span class="o">=</span> <span class="n">Project</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;mapdl_motorbike_frame&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;MAPDL Motorbike Frame&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_project</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, a job_definition object is created.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">job_def</span> <span class="o">=</span> <span class="n">JobDefinition</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;JobDefinition.1&quot;</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="file-resources">
<h2>File resources<a class="headerlink" href="#file-resources" title="Permalink to this heading">#</a></h2>
<p>The first step to fill the project job_definition is to define the files resources. Besides the name and type,
for each file we need to specify the <code class="docutils literal notranslate"><span class="pre">evaluation_path</span></code>, i.e. the relative path under which the file instance
for a design point evaluation will be stored. Moreover, if the file needs to be uploaded to the server, we also need to provide the path to the local file
as <code class="docutils literal notranslate"><span class="pre">src</span></code> argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Input File</span>
<span class="n">files</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">File</span><span class="p">(</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mac&quot;</span><span class="p">,</span><span class="n">evaluation_path</span><span class="o">=</span><span class="s2">&quot;motorbike_frame.mac&quot;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="s2">&quot;motorbike_frame.mac&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="c1"># Output Files</span>
<span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">File</span><span class="p">(</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="n">evaluation_path</span><span class="o">=</span><span class="s2">&quot;motorbike_frame_results.txt&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">File</span><span class="p">(</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;img&quot;</span><span class="p">,</span> <span class="n">evaluation_path</span><span class="o">=</span><span class="s2">&quot;file000.jpg&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;image/jpeg&quot;</span><span class="p">,</span> <span class="n">collect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="p">)</span>
<span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">File</span><span class="p">(</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;img2&quot;</span><span class="p">,</span> <span class="n">evaluation_path</span><span class="o">=</span><span class="s2">&quot;file001.jpg&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;image/jpeg&quot;</span><span class="p">,</span> <span class="n">collect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="p">)</span>
<span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">File</span><span class="p">(</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="n">evaluation_path</span><span class="o">=</span><span class="s2">&quot;file.out&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span><span class="p">,</span> <span class="n">collect</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>File resources are then created on the server.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">create_files</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

<span class="c1"># For convenience, we keep a reference to the input and result files.</span>
<span class="n">mac_file</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">result_file</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="parameters-definition">
<h2>Parameters definition<a class="headerlink" href="#parameters-definition" title="Permalink to this heading">#</a></h2>
<p>Creating a parameter requires to first provide a parameter definition and then specify a parameter location.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Input params: Dimensions of three custom tubes</span>
<span class="n">float_input_params</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">pd</span> <span class="o">=</span> <span class="n">job_def</span><span class="o">.</span><span class="n">add_float_parameter_definition</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;tube</span><span class="si">%i</span><span class="s1">_radius&#39;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">lower_limit</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">upper_limit</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="mf">12.0</span> <span class="p">)</span>
    <span class="n">job_def</span><span class="o">.</span><span class="n">add_parameter_mapping</span><span class="p">(</span><span class="n">key_string</span><span class="o">=</span><span class="s1">&#39;radius(</span><span class="si">%i</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">parameter_definition_name</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">file_id</span><span class="o">=</span><span class="n">mac_file</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="n">float_input_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>
    <span class="n">pd</span> <span class="o">=</span> <span class="n">job_def</span><span class="o">.</span><span class="n">add_float_parameter_definition</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;tube</span><span class="si">%i</span><span class="s1">_thickness&#39;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span><span class="n">lower_limit</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">upper_limit</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">1.0</span> <span class="p">)</span>
    <span class="n">job_def</span><span class="o">.</span><span class="n">add_parameter_mapping</span><span class="p">(</span><span class="n">key_string</span><span class="o">=</span><span class="s1">&#39;thickness(</span><span class="si">%i</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">parameter_definition_name</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">file_id</span><span class="o">=</span><span class="n">mac_file</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="n">float_input_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>

<span class="c1"># Input params: Custom types used for all the different tubes of the frame</span>
<span class="n">str_input_params</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">22</span><span class="p">):</span>
    <span class="n">pd</span> <span class="o">=</span> <span class="n">job_def</span><span class="o">.</span><span class="n">add_string_parameter_definition</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tube</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">value_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;3&quot;</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">job_def</span><span class="o">.</span><span class="n">add_parameter_mapping</span><span class="p">(</span><span class="n">key_string</span><span class="o">=</span><span class="s1">&#39;tubes(</span><span class="si">%i</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">parameter_definition_name</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">file_id</span><span class="o">=</span><span class="n">mac_file</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="n">str_input_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>

<span class="c1"># Output Parames</span>
<span class="k">for</span> <span class="n">pname</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;torsion_stiffness&quot;</span><span class="p">,</span> <span class="s2">&quot;max_stress&quot;</span><span class="p">]:</span>
    <span class="n">pd</span> <span class="o">=</span> <span class="n">job_def</span><span class="o">.</span><span class="n">add_float_parameter_definition</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pname</span><span class="p">)</span>
    <span class="n">job_def</span><span class="o">.</span><span class="n">add_parameter_mapping</span><span class="p">(</span><span class="n">key_string</span><span class="o">=</span><span class="n">pname</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">parameter_definition_name</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">file_id</span><span class="o">=</span><span class="n">result_file</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="process-step">
<h2>Process Step<a class="headerlink" href="#process-step" title="Permalink to this heading">#</a></h2>
<p>In a process step, we specify which application should be executed, its requirements, which input and output files are linked to it, and optionally also the criteria for determining whether the process step completes successfully.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process step</span>
<span class="n">job_def</span><span class="o">.</span><span class="n">add_task_definition</span><span class="p">(</span>   <span class="n">name</span><span class="o">=</span><span class="s2">&quot;MAPDL_run&quot;</span><span class="p">,</span>
                        <span class="n">application_name</span><span class="o">=</span><span class="s2">&quot;ANSYS Mechanical APDL&quot;</span><span class="p">,</span>
                        <span class="n">application_version</span><span class="o">=</span><span class="s2">&quot;20.1&quot;</span><span class="p">,</span>
                        <span class="n">execution_command</span><span class="o">=</span><span class="s2">&quot;\ %\ executable\ %\ -b -i \ %</span><span class="se">\f</span><span class="s2">ile:mac\ %\ -o file.out&quot;</span><span class="p">,</span>
                        <span class="n">max_execution_time</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span>
                        <span class="n">cpu_core_usage</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">execution_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">memory</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
                        <span class="n">disk_space</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                        <span class="n">input_file_ids</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[:</span><span class="mi">1</span><span class="p">]],</span>
                        <span class="n">output_file_ids</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="mi">1</span><span class="p">:]],</span>
                        <span class="n">success_criteria</span><span class="o">=</span> <span class="n">SuccessCriteria</span><span class="p">(</span>
                            <span class="n">return_code</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                            <span class="n">expressions</span><span class="o">=</span> <span class="p">[</span><span class="s2">&quot;values[&#39;tube1_radius&#39;]&gt;=4.0&quot;</span><span class="p">,</span> <span class="s2">&quot;values[&#39;tube1_thickness&#39;]&gt;=0.5&quot;</span><span class="p">],</span>
                            <span class="n">required_output_file_ids</span><span class="o">=</span><span class="p">[</span> <span class="n">f</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="p">],</span>
                            <span class="n">require_all_output_files</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">required_output_parameter_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;02qPAKWH62wIdNjaD7Uo0l&quot;</span><span class="p">,</span> <span class="s2">&quot;02qPAKWHB1fOcSEc27qUg9&quot;</span><span class="p">,</span> <span class="s2">&quot;02qPAKWHBpZZG1DdoMvjbG&quot;</span><span class="p">],</span>
                            <span class="n">require_all_output_parameters</span><span class="o">=</span><span class="kc">False</span>
                        <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>Note that multiple process steps can be defined.</p>
</section>
<section id="fitness-definition">
<h2>Fitness definition<a class="headerlink" href="#fitness-definition" title="Permalink to this heading">#</a></h2>
<p>In an optimization context, different type of fitness terms can be combined into a fitness definition object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fd</span> <span class="o">=</span> <span class="n">FitnessDefinition</span><span class="p">(</span><span class="n">error_fitness</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">fd</span><span class="o">.</span><span class="n">add_fitness_term</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;design_objective&quot;</span><span class="p">,</span> <span class="n">weighting_factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;map_design_objective( values[&#39;weight&#39;], 7.5, 5.5)&quot;</span><span class="p">)</span>
<span class="n">fd</span><span class="o">.</span><span class="n">add_fitness_term</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;torsional_stiffness&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;target_constraint&quot;</span><span class="p">,</span> <span class="n">weighting_factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;map_target_constraint( values[&#39;torsion_stiffness&#39;], 1313.0, 5.0, 30.0 )&quot;</span> <span class="p">)</span>
<span class="n">fd</span><span class="o">.</span><span class="n">add_fitness_term</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;max_stress&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;limit_constraint&quot;</span><span class="p">,</span> <span class="n">weighting_factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">expression</span><span class="o">=</span><span class="s2">&quot;map_limit_constraint( values[&#39;max_stress&#39;], 451.0, 50.0 )&quot;</span><span class="p">)</span>
<span class="n">job_def</span><span class="o">.</span><span class="n">fitness_definition</span> <span class="o">=</span><span class="n">fd</span>
</pre></div>
</div>
</section>
<section id="submit-the-job-definition">
<h2>Submit the job_definition<a class="headerlink" href="#submit-the-job-definition" title="Permalink to this heading">#</a></h2>
<p>The next step is to send the job_definition to the server.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">job_def</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">create_job_definitions</span><span class="p">([</span><span class="n">job_def</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="design-points">
<h2>Design Points<a class="headerlink" href="#design-points" title="Permalink to this heading">#</a></h2>
<p>Finally, 10 design points with randomly  chosen parameter values are created and set to pending.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span> <span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">lower_limit</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">upper_limit</span><span class="o">-</span><span class="n">p</span><span class="o">.</span><span class="n">lower_limit</span><span class="p">)</span>  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">float_input_params</span> <span class="p">}</span>
    <span class="n">values</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value_list</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">str_input_params</span><span class="p">})</span>
    <span class="n">dps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Job</span><span class="p">(</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Job.</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">eval_status</span><span class="o">=</span><span class="s2">&quot;pending&quot;</span><span class="p">)</span> <span class="p">)</span>

<span class="n">dps</span> <span class="o">=</span> <span class="n">job_def</span><span class="o">.</span><span class="n">create_jobs</span><span class="p">(</span><span class="n">dps</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright (c) 2022 ANSYS, Inc.. All rights reserved.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>